; This stunnel config is managed by Puppet.
<% if protocol %>protocol = <%= protocol %><% end -%>
sslVersion = <%= ssl_version %>
<% if client %>client = yes<% end -%>

setuid = <%= user %>
setgid = <%= group %>
pid = <%= pid %>
<% if chroot %>chroot = <%= chroot %><% end -%>

socket = l:TCP_NODELAY=1
socket = r:TCP_NODELAY=1
TIMEOUTclose = 0

debuglevel = <%= debuglevel %>
output = <%= output %>

<% if verify %>verify = <%= verify %><% end -%>
<% if cert %>cert = <%= cert %><% end -%>
<% if key %>key = <%= key %><% end -%>
<% if cafile %>CAfile = <%= cafile %><% end -%>
<% if crlfile %>CRLfile = <%= crlfile %><% end -%>

<% services.each_pair do |service, param| %>
[<%= service %>]
accept = <% if param['accept'] %><%= param['accept'] %><% else %><%= accept %><% end -%>
<% if param['connect'] %>connect = <%= param['connect'] %><% elseif connect %>connect = <%= connect %><% end -%>
<% if param['cert'] %>cert = <%= param['cert'] %><% elseif cert %>cert = <%= cert %><% end -%>
<% if param['key'] %>key = <%= param['key'] %><% elseif key %>key = <%= key %><% end -%>
<% if param['cafile'] %>CAfile = <%= param['cafile'] %><% elseif cert %>CAfile = <%= cafile %><% end -%>
<% if param['crlfile'] %>CRLfile = <%= param['crlfile'] %><% elseif crlfile %>CRLfile = <%= crlfile %><% end -%>

<% end -%>