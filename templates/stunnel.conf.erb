; This stunnel config is managed by Puppet.
<% if protocol %>protocol = <%= protocol %><% end -%>
sslVersion = <%= ssl_version %>
<% if client %>client = yes<% end -%>

setuid = <%= user %>
setgid = <%= group %>
pid = <%= pid %>
<% if chroot %>chroot = <%= chroot %><% end -%>

socket = l:TCP_NODELAY=1
socket = r:TCP_NODELAY=1
TIMEOUTclose = 0

debug = <%= debug_level %>
output = <%= output %>

<% if verify %>verify = <%= verify %><% end -%>
<% if cert %>cert = <%= cert %><% end -%>
<% if key %>key = <%= CAfile %><% end -%>
<% if CAfile %>CAfile = <%= CAfile %><% end -%>
<% if CRLfile %>CRLfile = <%= CRLfile %><% end -%>

<% services.each_pair do |service, param| %>
[<%= service %>]
accept = <%= param['accept'] %>
cert = <%= param['cert'] %>
connect = <% if param['connect'] %><%= param['connect'] %><% else %><%= connect %><% end -%>
<% end -%>